/**
 * pipe.js - EBU Pipe Data Collection JavaScript Library
 * @version v0.6.7
 * @generated 2018-02-01T13:43:17.163Z
 * @link https://tech.ebu.ch/groups/recsys
 * @license Copyright 2015-2017, EBU
 */
!function(){var e,t=["pipe-collect.ebu.io"],n="v1/",r="collect",o="pipeconfig",i="__pipe.gif",a="_pipe",c=!1,s="_pipe_",l=100,u=s+"historyElements",d=function(e){return e?e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,""):""},f="undefined"!=typeof window.crypto&&"undefined"!=typeof window.crypto.getRandomValues?function(){var e=new Uint16Array(8);window.crypto.getRandomValues(e);var t=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return t(e[0])+t(e[1])+"-"+t(e[2])+"-"+t(e[3])+"-"+t(e[4])+"-"+t(e[5])+t(e[6])+t(e[7])}:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})},h=function(){var e,t,n;if((n=(n=window.navigator)?n.plugins:null)&&n.length)for(var r=0;r<n.length&&!t;r++){var o=n[r];-1<o.name.indexOf("Shockwave Flash")&&(t=o.description)}if(!t)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),t=e.GetVariable("$version")}catch(i){}if(!t)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),t="WIN 6,0,21,0",e.AllowScriptAccess="always",t=e.GetVariable("$version")}catch(a){}if(!t)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),t=e.GetVariable("$version")}catch(c){}return t&&(e=t.match(/[\d]+/g))&&3<=e.length&&(t=e[0]+"."+e[1]+" r"+e[2]),t||void 0},p=function(){var e=(new Date).getTimezoneOffset();return e/60};"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return this.slice(0,e.length)==e}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e){return this.slice(-e.length)==e});var g={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){if(!window.atob){var t,n,r,o,i,a,c,s="",l=0;for(e=g._utf8_encode(e);l<e.length;)t=e.charCodeAt(l++),n=e.charCodeAt(l++),r=e.charCodeAt(l++),o=t>>2,i=(3&t)<<4|n>>4,a=(15&n)<<2|r>>6,c=63&r,isNaN(n)?a=c=64:isNaN(r)&&(c=64),s=s+g._keyStr.charAt(o)+g._keyStr.charAt(i)+g._keyStr.charAt(a)+g._keyStr.charAt(c);return s}return window.atob(e)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);128>r?t+=String.fromCharCode(r):r>127&&2048>r?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}},w=function(e){var t="; "+document.cookie,n=t.split("; "+e+"=");return 2==n.length?n.pop().split(";").shift():void 0},v=function(){if(e)return e;var t=window.location.host.match(/(?:[^.]+\.)?(\w*(?:\.\w*)|localhost|(?:\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))(:\d*)?$/)||[];return t[1]},_=function(){return w(a+"_s")},m=function(){var e=f(),t=v();return document.cookie=a+"_s="+e+";path=/;domain="+t,e},y=function(){return parseInt(w(a+"_st"))},S=function(){var e=(new Date).getTime(),t=v();return document.cookie=a+"_st="+e+";path=/;domain="+t,e},b=function(){return w(a+"_c")},x=function(){var e=f(),t=v(),n=new Date(25353216e5).toUTCString();return document.cookie=a+"_c="+e+";expires="+n+";path=/;domain="+t,e},O=function(e){var t=document.location;if(t){var n=t.pathname||"";C(e,"location",t.protocol+"//"+t.hostname+n+t.search),C(e,"referrer",document.referrer),C(e,"page",n),C(e,"hostname",t.hostname)}C(e,"title",function(){return document.title||void 0}()),C(e,"charset",document.characterSet||document.charset||""),window.screen&&(C(e,"screen_size",window.screen.width+"x"+window.screen.height),C(e,"screen_colors",window.screen.colorDepth+"-bit")),window.navigator&&(C(e,"language",window.navigator.language||window.navigator.browserLanguage||""),C(e,"java_enabled",window.navigator&&"function"==typeof window.navigator.javaEnabled&&window.navigator.javaEnabled()||!1));var r=document.documentElement,o=document.body,i=o&&o.clientWidth&&o.clientHeight,a=[];r&&r.clientWidth&&r.clientHeight&&("CSS1Compat"===document.compatMode||!i)?a=[r.clientWidth,r.clientHeight]:i&&(a=[o.clientWidth,o.clientHeight]);var c=0>=a[0]||0>=a[1]?"":a.join("x");C(e,"viewport_size",c),C(e,"flash_version",h()),C(e,"timezone",p())},C=function(e,t,n){e[t]=n},I=function(e){return void 0!=e&&-1<(e.constructor+"").indexOf("String")},j=function(e){return"function"==typeof e},k=function(){return window.XMLHttpRequest},T=function(e,t,n){var r=e+t,o=new XMLHttpRequest,i=!0;if(o.onreadystatechange=function(){4==o.readyState?D._connectionUp():0===o.readyState&&D._connectionDown()},n)try{o.open("POST",r,i),o.setRequestHeader("Content-Type","application/json; charset=UTF-8"),o.send(n)}catch(a){D._connectionDown(),D.qCollect.push([t,n])}else try{o.open("GET",r,i),o.send(null)}catch(a){D._connectionDown(),D.qCollect.push([t,n])}return!0},U=function(e,t,n){var r=e+t;n&&(r=r+"&d="+g.encode(JSON.stringify(n)));var o=new Image(1,1);return o.onload=function(){D._connectionUp()},o.onerror=function(){D._connectionDown()},o.src=r,!0},q=function(){var e=s+"internal__test__";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}},A=I(window.EBUPipeQName)&&d(window.EBUPipeQName)||"_pipe",D=function(){D._handle(arguments)};D.siteKey="",D.userId="",D.collectId="",D.collectStartTime=0,D.sessionId="",D.sessionStartTime=0,D.cookieId="",D.browserDataObject={},D.dataObject={},D.qCollect=[],D.qPipe=[],D.enabled=!1,D.connectionIsUp=!0,D.endpoints=t,D.currentCollectBaseUrl="",D.flags={},D.loaded=!1,D.initialized=!1,D.registered=!1,D._choose_endpoint=function(){if(D.endpoints.length>0){var e=D.endpoints[0];return e.startsWith("//")||(e="//"+e),e.endsWith("/")||(e+="/"),D.currentCollectBaseUrl=e,!0}return!1},D._load_config=function(){D._choose_endpoint();var e=new XMLHttpRequest,t=D.currentCollectBaseUrl+n+o;e.onreadystatechange=function(){if(4==e.readyState)if(200==e.status){var t=JSON.parse(e.responseText);t&&(D.enabled=t.enabled,D.endpoints=t.endpoints,D._choose_endpoint(),D.flags=t.flags,D.initialized=!0,D._handleQueue())}else D.enabled=c},e.open("GET",t,!0),e.send()},D.register=function(e){return 1==e.length||2==e.length?(D.siteKey=e[0],2==e.length&&(D.userId=e[1]),D._load_config(),D.collectId=f(),D.sessionId=_()||m(),D.sessionStartTime=y()||S(),D.cookieId=b()||x(),O(D.browserDataObject),D.registered=!0,!0):!1},D.setUserId=function(e){return 1==e.length?(D.userId=e[0],!0):!1},D.setEndpoint=function(e){if(e&&1==e.length){var t=e[0];return D.endpoints=t.constructor===Array?e[0]:[e[0]],!0}return!1},D.setCookiePrefix=function(e){return 1==e.length?(a=e[0],!0):!1},D.setCookieDomain=function(t){return 1==t.length?(e=t[0],!0):!1},D.set=function(e){if(1==e.length){if(e[0]){var t=e[0];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(D.dataObject[n]=t[n]);return!0}}else 2==e.length&&I(e[0])&&(D.dataObject[e[0]]=e[1]);return!1},D.new=function(){var e=window[A],t=window[A]=D;return t.collectStartTime=e.startTime,e.q&&(D.qPipe=e.q,D._handleQueue()),D.loaded=!0,!0},D._handle=function(e){var t=[].slice.call(e),n=t.shift();return j(D[n])&&D[n](t),!0},D._handleQueue=function(){if(D.qPipe.length>0){var e=D.qPipe;for(D.qPipe=[];e.length>0;){var t=e.shift();D._handle(t)}}},D.collect=function(e){if(!D.registered||!D.enabled)return D.enabled?!0:(e.unshift("collect"),D.qPipe.push(e),!0);if(1==e.length||2==e.length){var t=e[0],n={};if(n.action=t,2==e.length)if(I(e[1]))n.content_id=e[1];else if(e[1])for(var r in e[1])Object.prototype.hasOwnProperty.call(e[1],r)&&(n[r]=e[1][r]);return D._send_action(t,n)}return!1},D.putStorage=function(e){if(D.registered&&D.enabled&&q()&&2===e.length){var t=s+e[0],n=e[1];return localStorage.setItem(t,n),!0}return!1},D.getStorage=function(e){var t=null,n=e[1];if(q()&&2===e.length){var r=s+e[0],o=localStorage.getItem(r);if(n&&"function"==typeof n)return o?(n(t,o),!0):(t={message:"No value found for "+e[0]+" (internal "+r+")"},n(t,null),!0)}else if(n&&"function"==typeof n)return t={message:"Browser does not support localStorage"},n(t,null),!0;return!1},D.pushHistoryElement=function(e){if(q()===!0&&1===e.length){var t=e[0],n=JSON.parse(localStorage.getItem(u));if("[object Array]"===Object.prototype.toString.call(n))for(n.push(t);n.length>l;)n.shift();else n=[t];return localStorage.setItem(u,JSON.stringify(n)),!0}return!1},D.getDistinctHistoryElementIds=function(e){var t=null,n=[],r={};if(D.registered&&D.enabled&&q()===!0&&1===e.length){var o=e[0],i=JSON.parse(localStorage.getItem(u));if("[object Array]"===Object.prototype.toString.call(i)&&o&&"function"==typeof o){for(var a=0,c=i.length;c>a;++a){var s=i[a].id;r.hasOwnProperty(s)||(n.push(s),r[s]=1)}return o(t,n),!0}}return t={message:"Unable to build distinct history element ids."},o(t,null),!1},D._send_action=function(e,t){var n="?s="+D.siteKey+"&e="+e,r={},o=(new Date).getTime();r.site_key=D.siteKey,r.cookie_id=D.cookieId,r.session_start=D.sessionStartTime,r.session_duration=o-D.sessionStartTime,r.session_cookie_id=D.sessionId,r.page_start=D.collectStartTime,r.page_duration=o-D.collectStartTime,r.send_start=o,r.user_id=D.userId||"unknown",r.browser_data=D.browserDataObject,r.data={};for(var i in D.dataObject)Object.prototype.hasOwnProperty.call(D.dataObject,i)&&(r.data[i]=D.dataObject[i]);for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r.data[i]=t[i]);return r=JSON.stringify(r),D._dispatch(n,r)},D._dispatch=function(e,t){if(k()){var o=D.currentCollectBaseUrl+n+r;return T(o,e,t)}var a=D.currentCollectBaseUrl+n+i;return U(a,e,t)},D._connectionUp=function(){for(D.connectionIsUp=!0;D.qCollect.length>0;){var e=D.qCollect.shift();2==e.length&&D._dispatch(e[0],e[1])}},D._connectionDown=function(){D.connectionIsUp=!1},function(){var e=D.new;"prerender"!=document.visibilityState&&e()}()}(window);